
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SVG Whiteboard</title>
<style>
    body, html {
        margin: 0; padding: 0; height: 100%; width: 100%;
        overflow: hidden; display: flex; flex-direction: column;
        font-family: sans-serif;
    }
    #toolbar {
        display: flex; gap: 10px; padding: 8px; background: #f0f0f0;
        flex-wrap: wrap; align-items: center;
    }
    #board {
        flex: 1; width: 100%; height: 100%;
        background: transparent;
    }
    svg {
        width: 100%; height: 100%;
        touch-action: none; /* Important for mobile drawing */
    }
    input[type="color"], input[type="number"] {
        padding: 4px;
    }
    button {
        padding: 6px 10px; cursor: pointer;
    }
</style>
</head>
<body>
<div id="toolbar">
    <input type="color" id="colorPicker" value="#000000">
    <input type="number" id="strokeWidth" value="3" min="1" max="50" style="width:60px;">
    <button id="eraseBtn">Erase</button>
    <button id="openSVG">Open SVG</button>
    <button id="saveSVG">Save SVG</button>
    <button id="savePNG">Save PNG</button>
    <input type="file" id="fileInput" accept=".svg" style="display:none;">
</div>
<div id="board">
    <svg id="svgBoard" xmlns="http://www.w3.org/2000/svg"></svg>
</div>

<script>
const svg = document.getElementById('svgBoard');
let drawing = false, currentPath = null;
let color = document.getElementById('colorPicker').value;
let strokeWidth = document.getElementById('strokeWidth').value;
let erasing = false;

// Update color and stroke width
document.getElementById('colorPicker').addEventListener('input', e => color = e.target.value);
document.getElementById('strokeWidth').addEventListener('input', e => strokeWidth = e.target.value);

// Erase toggle
document.getElementById('eraseBtn').addEventListener('click', () => {
    erasing = !erasing;
    document.getElementById('eraseBtn').style.background = erasing ? '#ffcccc' : '';
});

// Start drawing
function startDraw(x, y) {
    drawing = true;
    currentPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
    currentPath.setAttribute('fill', 'none');
    currentPath.setAttribute('stroke', erasing ? '#ffffff' : color);
    currentPath.setAttribute('stroke-width', strokeWidth);
    currentPath.setAttribute('stroke-linecap', 'round');
    currentPath.setAttribute('stroke-linejoin', 'round');
    currentPath.setAttribute('d', `M${x},${y}`);
    svg.appendChild(currentPath);
}

// Continue drawing
function draw(x, y) {
    if (!drawing || !currentPath) return;
    let d = currentPath.getAttribute('d');
    currentPath.setAttribute('d', d + ` L${x},${y}`);
}

// Stop drawing
function stopDraw() {
    drawing = false;
    currentPath = null;
}

// Mouse events
svg.addEventListener('mousedown', e => startDraw(e.offsetX, e.offsetY));
svg.addEventListener('mousemove', e => draw(e.offsetX, e.offsetY));
svg.addEventListener('mouseup', stopDraw);
svg.addEventListener('mouseleave', stopDraw);

// Touch events
svg.addEventListener('touchstart', e => {
    e.preventDefault();
    const t = e.touches[0];
    const rect = svg.getBoundingClientRect();
    startDraw(t.clientX - rect.left, t.clientY - rect.top);
});
svg.addEventListener('touchmove', e => {
    e.preventDefault();
    const t = e.touches[0];
    const rect = svg.getBoundingClientRect();
    draw(t.clientX - rect.left, t.clientY - rect.top);
});
svg.addEventListener('touchend', stopDraw);

// Open SVG
document.getElementById('openSVG').addEventListener('click', () => {
    document.getElementById('fileInput').click();
});
document.getElementById('fileInput').addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = evt => svg.innerHTML = evt.target.result.match(/<svg[^>]*>([\s\S]*?)<\/svg>/)[1];
    reader.readAsText(file);
});

// Save SVG
document.getElementById('saveSVG').addEventListener('click', () => {
    const svgData = `<svg xmlns="http://www.w3.org/2000/svg" width="${svg.clientWidth}" height="${svg.clientHeight}">${svg.innerHTML}</svg>`;
    const blob = new Blob([svgData], {type: 'image/svg+xml'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'whiteboard.svg'; a.click();
    URL.revokeObjectURL(url);
});

// Save PNG
document.getElementById('savePNG').addEventListener('click', () => {
    const svgData = `<svg xmlns="http://www.w3.org/2000/svg" width="${svg.clientWidth}" height="${svg.clientHeight}">${svg.innerHTML}</svg>`;
    const img = new Image();
    const svgBlob = new Blob([svgData], {type: 'image/svg+xml'});
    const url = URL.createObjectURL(svgBlob);
    img.onload = () => {
        const canvas = document.createElement('canvas');
        canvas.width = svg.clientWidth;
        canvas.height = svg.clientHeight;
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0);
        URL.revokeObjectURL(url);
        const pngUrl = canvas.toDataURL('image/png');
        const a = document.createElement('a');
        a.href = pngUrl; a.download = 'whiteboard.png'; a.click();
    };
    img.src = url;
});
</script>
</body>
</html>
